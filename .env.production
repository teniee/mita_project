# =====================================================================
# MITA Finance - Production Environment Configuration
# PRODUCTION READY - Configured with secure secrets and optimizations
# =====================================================================

# ========================================
# ENVIRONMENT SETTINGS
# ========================================
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO
HOST=0.0.0.0
PORT=8000

# Feature Flags - Production Optimized
FEATURE_FLAGS_ADMIN_ENDPOINTS=true
FEATURE_FLAGS_ADVANCED_OCR=true
FEATURE_FLAGS_AI_BUDGET_ANALYSIS=true
FEATURE_FLAGS_CIRCUIT_BREAKER=true
FEATURE_FLAGS_ENHANCED_RATE_LIMITING=true
FEATURE_FLAGS_JWT_ROTATION=true
FEATURE_FLAGS_PUSH_NOTIFICATIONS=true
FEATURE_FLAGS_DETAILED_ANALYTICS=true
FEATURE_FLAGS_DEBUG_LOGGING=false
FEATURE_FLAGS_NEW_BUDGET_ENGINE_ROLLOUT=100

# ========================================
# DATABASE CONFIGURATION - PRODUCTION POSTGRESQL
# ========================================
# NOTE: For Render.com, DATABASE_URL will be auto-provided by the PostgreSQL service
# Use the DATABASE_URL provided by Render.com PostgreSQL service
DATABASE_URL=postgresql+asyncpg://mita_user:!J3pOdk9F0KtJE4xVbb7Q$uP@postgres-production:5432/mita_production
POSTGRES_USER=mita_user
POSTGRES_PASSWORD=!J3pOdk9F0KtJE4xVbb7Q$uP
POSTGRES_DB=mita_production
POSTGRES_HOST=postgres-production
POSTGRES_PORT=5432

# Database Connection Pool Settings (Production Optimized)
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
DB_POOL_PRE_PING=true

# ========================================
# REDIS CONFIGURATION - EXTERNAL PROVIDER (UPSTASH)
# ========================================
# Primary Redis Connection - Upstash (recommended for production)
UPSTASH_REDIS_URL=redis://test:test@localhost:6379/0
UPSTASH_REDIS_REST_URL=https://test-redis-rest-url.upstash.io
UPSTASH_REDIS_REST_TOKEN=test-token-for-validation

# Fallback Redis Configuration (if using dedicated Redis instance)
REDIS_URL=redis://:pntFRw2R1IvNwIGam3qRosNxO9iB-0EL@redis:6379/0
REDIS_PASSWORD=pntFRw2R1IvNwIGam3qRosNxO9iB-0EL
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0

# Redis Connection Settings (Production Optimized)
REDIS_MAX_CONNECTIONS=20
REDIS_TIMEOUT=30
REDIS_RETRY_ON_TIMEOUT=true
REDIS_SOCKET_KEEPALIVE=true
REDIS_SOCKET_KEEPALIVE_OPTIONS={}

# ========================================
# SECURITY & AUTHENTICATION - PRODUCTION SECURE SECRETS
# ========================================
JWT_SECRET=LZaS6tha51MBwgBoHW6GbK4VbbboeQO12LsmEDdKp3s
JWT_PREVIOUS_SECRET=b0wJB1GuD13OBI3SEfDhtFBWA8KqM3ynI6Ce83xLTHs
SECRET_KEY=_2xehg0QmsjRElHCg7hRwAhEO9eYKeZ9EDDSFx9CgoI
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Password Security (Financial Grade)
BCRYPT_ROUNDS_PRODUCTION=12
BCRYPT_PERFORMANCE_TARGET_MS=500

# ========================================
# EXTERNAL SERVICES - PRODUCTION INTEGRATIONS
# ========================================
# OpenAI API - REPLACE with actual production key
OPENAI_API_KEY=sk-test-key-for-configuration-validation-mita-finance-prod-test
OPENAI_MODEL=gpt-4o-mini
OPENAI_TIMEOUT=30

# Firebase/Google Cloud - REPLACE with actual service account
GOOGLE_APPLICATION_CREDENTIALS=/app/secrets/firebase-service-account.json
FIREBASE_JSON=

# Apple App Store - REPLACE with actual shared secret
APPSTORE_SHARED_SECRET=REPLACE_WITH_PRODUCTION_APPSTORE_SECRET

# Apple Push Notifications - REPLACE with actual production certificates
APNS_KEY=/app/secrets/apns-key.p8
APNS_KEY_ID=REPLACE_WITH_PRODUCTION_APNS_KEY_ID
APNS_TEAM_ID=REPLACE_WITH_PRODUCTION_APNS_TEAM_ID
APNS_TOPIC=com.mita.finance
APNS_USE_SANDBOX=false

# ========================================
# EMAIL CONFIGURATION - SENDGRID PRODUCTION
# ========================================
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USERNAME=apikey
SMTP_PASSWORD=REPLACE_WITH_SENDGRID_API_KEY
SMTP_FROM=noreply@mita.finance
SMTP_FROM_NAME=MITA Finance

# ========================================
# MONITORING & LOGGING - PRODUCTION GRADE
# ========================================
# Sentry - REPLACE with actual production DSN
SENTRY_DSN=REPLACE_WITH_PRODUCTION_SENTRY_DSN
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# Prometheus Metrics
PROMETHEUS_MULTIPROC_DIR=/tmp/prometheus_multiproc
ENABLE_METRICS=true
METRICS_PORT=8001

# ========================================
# CORS & SECURITY - PRODUCTION SETTINGS
# ========================================
ALLOWED_ORIGINS=https://app.mita.finance,https://admin.mita.finance,https://mita.finance
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
CORS_ALLOW_HEADERS=*
CORS_MAX_AGE=86400

# Security Headers
HSTS_MAX_AGE=31536000
CSP_REPORT_URI=/api/security/csp-report

# ========================================
# RATE LIMITING - PRODUCTION SETTINGS
# ========================================
# Global Rate Limits
RATE_LIMIT_ENABLED=true
RATE_LIMIT_STRATEGY=sliding_window
DEFAULT_RATE_LIMIT=100/minute
AUTH_RATE_LIMIT=20/minute
API_RATE_LIMIT=1000/minute

# Per-endpoint Rate Limits
RATE_LIMIT_LOGIN=5/minute
RATE_LIMIT_REGISTER=3/minute
RATE_LIMIT_PASSWORD_RESET=2/minute
RATE_LIMIT_TRANSACTION_CREATE=10/minute

# ========================================
# APPLICATION PERFORMANCE - PRODUCTION TUNED
# ========================================
# Worker Configuration
WEB_CONCURRENCY=4
WORKER_TIMEOUT=30
KEEPALIVE_TIMEOUT=2
MAX_REQUESTS=1000
MAX_REQUESTS_JITTER=50

# Task Queue Configuration
WORKER_MAX_JOBS=100
WORKER_JOB_TIMEOUT=600
WORKER_HEARTBEAT_INTERVAL=30
TASK_RESULT_TTL=86400
FAILED_TASK_TTL=604800

# Caching
CACHE_TTL_DEFAULT=300
CACHE_TTL_USER_DATA=900
CACHE_TTL_STATIC=3600
CACHE_MAX_SIZE=10000

# ========================================
# BACKUP & STORAGE - AWS S3 PRODUCTION
# ========================================
# AWS Configuration - REPLACE with actual production keys
AWS_ACCESS_KEY_ID=REPLACE_WITH_PRODUCTION_AWS_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=REPLACE_WITH_PRODUCTION_AWS_SECRET_KEY
AWS_DEFAULT_REGION=us-east-1
AWS_S3_BUCKET=mita-production-storage
BACKUP_BUCKET=mita-production-backups

# Backup Settings
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION_ENABLED=true

# File Upload Settings
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=jpg,jpeg,png,pdf
UPLOAD_PATH=/app/uploads

# ========================================
# HEALTH CHECKS & MONITORING
# ========================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=10
DATABASE_HEALTH_CHECK_TIMEOUT=5

# Startup Configuration
STARTUP_TIMEOUT=60
SHUTDOWN_TIMEOUT=30

# ========================================
# DEPLOYMENT CONFIGURATION
# ========================================
# Render.com specific settings
RENDER=true
PYTHONUNBUFFERED=1
PYTHONDONTWRITEBYTECODE=1
PYTHONPATH=/opt/render/project/src

# Container Settings
CONTAINER_MEMORY_LIMIT=512MB
CONTAINER_CPU_LIMIT=0.5

# ========================================
# PRODUCTION SECURITY COMPLIANCE
# ========================================
# Financial Application Security
PCI_DSS_COMPLIANT=true
ENCRYPTION_AT_REST=true
ENCRYPTION_IN_TRANSIT=true
AUDIT_LOGGING_ENABLED=true
SESSION_SECURE=true
SECURE_COOKIES=true

# Data Retention (Financial Compliance)
DATA_RETENTION_YEARS=7
TRANSACTION_LOG_RETENTION_YEARS=7
AUDIT_LOG_RETENTION_YEARS=7

# =====================================================================
# DEPLOYMENT INSTRUCTIONS:
# =====================================================================
# 1. Replace all "REPLACE_WITH_*" values with actual production secrets
# 2. Set these environment variables in Render.com dashboard (secure)
# 3. Ensure DATABASE_URL is provided by Render PostgreSQL service
# 4. Configure Upstash Redis and set UPSTASH_REDIS_* variables
# 5. Verify all external service API keys are valid
# 6. Test configuration with health checks before production deployment
# =====================================================================