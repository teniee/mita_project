# MITA Finance Email Service - Production Environment Configuration
# Copy these variables to your production environment

# =============================================================================
# SENDGRID EMAIL SERVICE CONFIGURATION (REQUIRED)
# =============================================================================

# SendGrid API Configuration
SENDGRID_API_KEY=SG.your_sendgrid_api_key_here_from_sendgrid_console
SMTP_FROM=noreply@mita.finance
SMTP_FROM_NAME=MITA Finance

# Alternative Email Providers (Optional Backup)
MAILGUN_API_KEY=your_mailgun_api_key
MAILGUN_DOMAIN=mg.mita.finance
POSTMARK_API_KEY=your_postmark_api_key

# =============================================================================
# EMAIL QUEUE CONFIGURATION
# =============================================================================

# Queue Processing Settings
EMAIL_MAX_RETRIES=3
EMAIL_RETRY_DELAY=300
EMAIL_BATCH_SIZE=100
EMAIL_MAX_PROCESSING_TIME=300
EMAIL_DEAD_LETTER_RETENTION_DAYS=7

# Queue Worker Settings
EMAIL_WORKER_HEARTBEAT_INTERVAL=30
EMAIL_WORKER_HEALTH_CHECK_INTERVAL=60

# =============================================================================
# MOBILE APP INTEGRATION
# =============================================================================

# iOS App Configuration
IOS_APP_ID=your_ios_app_store_id
IOS_TEAM_ID=your_apple_developer_team_id

# Android App Configuration
ANDROID_PACKAGE_NAME=com.mita.finance
ANDROID_SHA256_FINGERPRINT=your_android_app_sha256_certificate_fingerprint

# Universal Links Configuration
UNIVERSAL_LINK_DOMAIN=links.mita.finance

# =============================================================================
# REDIS CONFIGURATION (for email queue)
# =============================================================================

# Primary Redis Configuration (Upstash recommended for production)
UPSTASH_REDIS_URL=rediss://default:your_password@your_upstash_endpoint:6380
UPSTASH_REDIS_REST_URL=https://your_upstash_rest_endpoint
UPSTASH_REDIS_REST_TOKEN=your_upstash_rest_token

# Redis Connection Settings
REDIS_MAX_CONNECTIONS=20
REDIS_TIMEOUT=30
REDIS_RETRY_ON_TIMEOUT=true

# =============================================================================
# EMAIL TEMPLATE CONFIGURATION
# =============================================================================

# Template Settings
EMAIL_TEMPLATE_DEBUG=false
EMAIL_TEMPLATE_CACHE=true

# Branding Configuration
EMAIL_BRAND_PRIMARY_COLOR=#0066cc
EMAIL_BRAND_SECONDARY_COLOR=#004499
EMAIL_BRAND_ACCENT_COLOR=#00cc66

# Company Information
EMAIL_COMPANY_NAME=MITA Finance
EMAIL_SUPPORT_EMAIL=support@mita.finance
EMAIL_PRIVACY_POLICY_URL=https://mita.finance/privacy
EMAIL_TERMS_OF_SERVICE_URL=https://mita.finance/terms

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Token Security
PASSWORD_RESET_TOKEN_EXPIRY_HOURS=2
EMAIL_VERIFICATION_TOKEN_EXPIRY_HOURS=24
EMAIL_TOKEN_MAX_ATTEMPTS=5

# Rate Limiting (requests per time period)
EMAIL_RATE_LIMIT_PASSWORD_RESET=3/5minutes
EMAIL_RATE_LIMIT_EMAIL_VERIFICATION=5/hour
EMAIL_RATE_LIMIT_GENERAL=100/hour

# =============================================================================
# MONITORING AND LOGGING
# =============================================================================

# Logging Configuration
EMAIL_LOG_LEVEL=INFO
EMAIL_STRUCTURED_LOGGING=true
EMAIL_LOG_FILE_PATH=/var/log/mita/email-service.log

# Monitoring Settings
EMAIL_METRICS_ENABLED=true
EMAIL_HEALTH_CHECK_ENABLED=true
EMAIL_DELIVERY_TRACKING=true

# Sentry Configuration for Error Tracking
SENTRY_DSN=https://your_sentry_dsn@sentry.io/project_id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# =============================================================================
# PERFORMANCE OPTIMIZATION
# =============================================================================

# Database Connection Pool
EMAIL_DB_POOL_SIZE=10
EMAIL_DB_MAX_OVERFLOW=20
EMAIL_DB_POOL_RECYCLE=3600

# Async Processing
EMAIL_ASYNC_TIMEOUT=30
EMAIL_MAX_CONCURRENT_JOBS=50

# =============================================================================
# COMPLIANCE CONFIGURATION
# =============================================================================

# GDPR Compliance
EMAIL_GDPR_COMPLIANCE=true
EMAIL_DATA_RETENTION_DAYS=2555  # 7 years for financial data

# Email Security Headers
EMAIL_SPF_ENABLED=true
EMAIL_DKIM_ENABLED=true
EMAIL_DMARC_POLICY=quarantine

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================

# Worker Process Configuration
EMAIL_WORKER_PROCESSES=2
EMAIL_WORKER_AUTO_RESTART=true
EMAIL_WORKER_MAX_MEMORY_MB=512

# Health Check Endpoints
EMAIL_HEALTH_CHECK_PORT=8001
EMAIL_METRICS_PORT=8002

# =============================================================================
# DEVELOPMENT/TESTING OVERRIDES
# =============================================================================

# Uncomment for development/testing
# EMAIL_TEMPLATE_DEBUG=true
# EMAIL_QUEUE_DEBUG=true
# SENDGRID_SANDBOX_MODE=true

# Test Email Configuration (for staging)
# TEST_EMAIL_RECIPIENT=testing@mita.finance
# EMAIL_SEND_TEST_EMAILS=false

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Email Feature Toggles
FEATURE_EMAIL_QUEUE_ENABLED=true
FEATURE_EMAIL_TEMPLATES_ENABLED=true
FEATURE_EMAIL_MOBILE_INTEGRATION=true
FEATURE_EMAIL_DELIVERY_TRACKING=true
FEATURE_EMAIL_SECURITY_ALERTS=true

# =============================================================================
# INSTRUCTIONS
# =============================================================================

# 1. Replace all placeholder values with your actual configuration
# 2. Set up SendGrid account and configure domain authentication
# 3. Configure Redis/Upstash for email queue
# 4. Set up mobile app deep linking configuration
# 5. Configure monitoring and alerting
# 6. Test all email types in staging environment
# 7. Deploy email worker process alongside main application
# 8. Monitor email delivery rates and queue performance

# =============================================================================
# SECURITY NOTES
# =============================================================================

# - Never commit this file with real values to version control
# - Use environment-specific secret management (AWS Secrets Manager, etc.)
# - Rotate API keys regularly
# - Monitor for suspicious email activity
# - Implement proper access controls for email administration endpoints
# - Regular security audits of email templates and content

# =============================================================================
# SUPPORT
# =============================================================================

# For questions or issues with email service configuration:
# - Review the email_service_deployment_guide.md
# - Check application logs for detailed error messages
# - Monitor email queue status via API endpoints
# - Contact technical support with specific error details