{% extends "base.html" %}

{% block content %}
<div class="alert alert-danger">
    <h1>🚨 URGENT: Suspicious Activity Detected</h1>
</div>

<p><strong>We've detected potentially suspicious activity on your MITA Finance account that requires your immediate attention.</strong></p>

<div class="alert alert-warning">
    <strong>⚠️ IMPORTANT:</strong> If this activity was not authorized by you, your account security may be compromised. Please take immediate action.
</div>

<div class="financial-highlight" style="border: 2px solid #cc0000; background-color: #fff5f5;">
    <h3>🔍 Suspicious Activity Report</h3>
    <table style="width: 100%; border-collapse: collapse;">
        <tr style="background-color: #ffe6e6;">
            <td style="padding: 12px; border: 1px solid #cc0000; font-weight: bold;">Activity Type:</td>
            <td style="padding: 12px; border: 1px solid #cc0000;">{{ activity_description }}</td>
        </tr>
        <tr>
            <td style="padding: 12px; border: 1px solid #cc0000; font-weight: bold;">Date & Time:</td>
            <td style="padding: 12px; border: 1px solid #cc0000;">{{ timestamp }}</td>
        </tr>
        <tr style="background-color: #ffe6e6;">
            <td style="padding: 12px; border: 1px solid #cc0000; font-weight: bold;">Location:</td>
            <td style="padding: 12px; border: 1px solid #cc0000;">{{ location }}</td>
        </tr>
        {% if ip_address %}
        <tr>
            <td style="padding: 12px; border: 1px solid #cc0000; font-weight: bold;">IP Address:</td>
            <td style="padding: 12px; border: 1px solid #cc0000;"><code>{{ ip_address }}</code></td>
        </tr>
        {% endif %}
        {% if device_info %}
        <tr style="background-color: #ffe6e6;">
            <td style="padding: 12px; border: 1px solid #cc0000; font-weight: bold;">Device:</td>
            <td style="padding: 12px; border: 1px solid #cc0000;">{{ device_info }}</td>
        </tr>
        {% endif %}
        <tr>
            <td style="padding: 12px; border: 1px solid #cc0000; font-weight: bold;">Account:</td>
            <td style="padding: 12px; border: 1px solid #cc0000;">{{ email }}</td>
        </tr>
    </table>
</div>

<div style="background-color: #cc0000; color: white; padding: 20px; border-radius: 6px; margin: 30px 0; text-align: center;">
    <h2 style="color: white; margin-top: 0;">🚨 IMMEDIATE ACTION REQUIRED</h2>
    <p style="font-size: 18px; margin-bottom: 20px;">Protect your account NOW</p>
    <a href="https://app.mita.finance/security/emergency" class="btn" style="background-color: white; color: #cc0000; font-weight: bold; border: 2px solid white;">SECURE MY ACCOUNT</a>
</div>

<h2>🛡️ Essential Security Steps</h2>

<p><strong>Take these actions immediately to protect your account:</strong></p>

<div style="counter-reset: step-counter;">
    <div style="counter-increment: step-counter; display: flex; margin: 20px 0; padding: 20px; background-color: #fff5f5; border-left: 4px solid #cc0000; border-radius: 0 6px 6px 0;">
        <div style="background-color: #cc0000; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; flex-shrink: 0;">1</div>
        <div>
            <h4 style="margin: 0 0 10px 0; color: #cc0000;">Change Your Password Immediately</h4>
            <p style="margin: 0; font-size: 14px;">Use a strong, unique password that you haven't used elsewhere.</p>
        </div>
    </div>
    
    <div style="counter-increment: step-counter; display: flex; margin: 20px 0; padding: 20px; background-color: #fff5f5; border-left: 4px solid #cc0000; border-radius: 0 6px 6px 0;">
        <div style="background-color: #cc0000; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; flex-shrink: 0;">2</div>
        <div>
            <h4 style="margin: 0 0 10px 0; color: #cc0000;">Enable Two-Factor Authentication</h4>
            <p style="margin: 0; font-size: 14px;">Add an extra layer of security to prevent unauthorized access.</p>
        </div>
    </div>
    
    <div style="counter-increment: step-counter; display: flex; margin: 20px 0; padding: 20px; background-color: #fff5f5; border-left: 4px solid #cc0000; border-radius: 0 6px 6px 0;">
        <div style="background-color: #cc0000; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; flex-shrink: 0;">3</div>
        <div>
            <h4 style="margin: 0 0 10px 0; color: #cc0000;">Review Account Activity</h4>
            <p style="margin: 0; font-size: 14px;">Check all recent transactions and account changes.</p>
        </div>
    </div>
    
    <div style="counter-increment: step-counter; display: flex; margin: 20px 0; padding: 20px; background-color: #fff5f5; border-left: 4px solid #cc0000; border-radius: 0 6px 6px 0;">
        <div style="background-color: #cc0000; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; flex-shrink: 0;">4</div>
        <div>
            <h4 style="margin: 0 0 10px 0; color: #cc0000;">Contact Our Security Team</h4>
            <p style="margin: 0; font-size: 14px;">Report the incident and get expert assistance.</p>
        </div>
    </div>
</div>

<h2>🔍 What This Means</h2>

<p>This suspicious activity could indicate:</p>

<div style="display: flex; flex-wrap: wrap; gap: 20px; margin: 20px 0;">
    <div style="flex: 1; min-width: 250px; padding: 20px; background-color: #fff2f2; border: 1px solid #ffb3b3; border-radius: 6px;">
        <div style="font-size: 24px; color: #cc0000; margin-bottom: 10px;">🔓</div>
        <h4 style="color: #cc0000; margin-bottom: 10px;">Unauthorized Access</h4>
        <p style="font-size: 14px; margin: 0;">Someone may have gained access to your account credentials.</p>
    </div>
    
    <div style="flex: 1; min-width: 250px; padding: 20px; background-color: #fff2f2; border: 1px solid #ffb3b3; border-radius: 6px;">
        <div style="font-size: 24px; color: #cc0000; margin-bottom: 10px;">📱</div>
        <h4 style="color: #cc0000; margin-bottom: 10px;">Compromised Device</h4>
        <p style="font-size: 14px; margin: 0;">A device you use may have been compromised by malware.</p>
    </div>
</div>

<div style="display: flex; flex-wrap: wrap; gap: 20px; margin: 20px 0;">
    <div style="flex: 1; min-width: 250px; padding: 20px; background-color: #fff2f2; border: 1px solid #ffb3b3; border-radius: 6px;">
        <div style="font-size: 24px; color: #cc0000; margin-bottom: 10px;">🎣</div>
        <h4 style="color: #cc0000; margin-bottom: 10px;">Phishing Attack</h4>
        <p style="font-size: 14px; margin: 0;">You may have entered credentials on a fake website.</p>
    </div>
    
    <div style="flex: 1; min-width: 250px; padding: 20px; background-color: #fff2f2; border: 1px solid #ffb3b3; border-radius: 6px;">
        <div style="font-size: 24px; color: #cc0000; margin-bottom: 10px;">💾</div>
        <h4 style="color: #cc0000; margin-bottom: 10px;">Data Breach</h4>
        <p style="font-size: 14px; margin: 0;">Your credentials may have been exposed in a third-party breach.</p>
    </div>
</div>

<h2>❓ Was This You?</h2>

<div style="background-color: #e6f3ff; border-left: 4px solid #0066cc; padding: 20px; margin: 20px 0;">
    <h4 style="color: #0066cc; margin-top: 0;">✅ If you recognize this activity:</h4>
    <ul style="margin-bottom: 0;">
        <li>You can safely ignore this alert</li>
        <li>Consider enabling location-based security notifications</li>
        <li>Review your security settings to prevent future alerts</li>
        <li>Update your trusted devices list</li>
    </ul>
</div>

<div style="background-color: #ffe6e6; border-left: 4px solid #cc0000; padding: 20px; margin: 20px 0;">
    <h4 style="color: #cc0000; margin-top: 0;">❌ If you DO NOT recognize this activity:</h4>
    <ul style="margin-bottom: 0;">
        <li><strong>DO NOT IGNORE THIS ALERT</strong></li>
        <li>Change your password immediately</li>
        <li>Enable two-factor authentication</li>
        <li>Contact our security team right away</li>
        <li>Monitor your account closely for any unauthorized changes</li>
    </ul>
</div>

<h2>🆘 Emergency Security Contacts</h2>

<div style="background-color: #cc0000; color: white; padding: 30px; border-radius: 8px; margin: 30px 0;">
    <h3 style="color: white; margin-top: 0; text-align: center;">🚨 24/7 Security Hotline</h3>
    
    <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: center;">
        <div style="text-align: center; min-width: 200px;">
            <div style="font-size: 24px; margin-bottom: 10px;">📧</div>
            <strong>Emergency Email</strong>
            <p style="margin: 5px 0;"><a href="mailto:security@mita.finance" style="color: white; text-decoration: underline;">security@mita.finance</a></p>
        </div>
        
        <div style="text-align: center; min-width: 200px;">
            <div style="font-size: 24px; margin-bottom: 10px;">📞</div>
            <strong>Security Hotline</strong>
            <p style="margin: 5px 0;">1-800-MITA-SEC</p>
            <p style="margin: 5px 0; font-size: 12px;">(1-800-648-2732)</p>
        </div>
        
        <div style="text-align: center; min-width: 200px;">
            <div style="font-size: 24px; margin-bottom: 10px;">💬</div>
            <strong>Live Chat</strong>
            <p style="margin: 5px 0;">Available in app</p>
            <p style="margin: 5px 0; font-size: 12px;">24/7 Support</p>
        </div>
    </div>
</div>

<h2>🛡️ Prevent Future Incidents</h2>

<p>Strengthen your account security with these recommendations:</p>

<div style="display: flex; flex-wrap: wrap; gap: 20px; margin: 20px 0;">
    <div style="flex: 1; min-width: 300px; background-color: #f8f9fa; padding: 20px; border-radius: 6px; border-left: 4px solid #0066cc;">
        <h4 style="color: #0066cc; margin-top: 0;">🔐 Strong Password Practices</h4>
        <ul style="font-size: 14px; margin-bottom: 0;">
            <li>Use a unique password for MITA Finance</li>
            <li>Include uppercase, lowercase, numbers, and symbols</li>
            <li>Make it at least 12 characters long</li>
            <li>Consider using a password manager</li>
            <li>Never share your password with anyone</li>
        </ul>
    </div>
    
    <div style="flex: 1; min-width: 300px; background-color: #f8f9fa; padding: 20px; border-radius: 6px; border-left: 4px solid #00cc66;">
        <h4 style="color: #00cc66; margin-top: 0;">📱 Two-Factor Authentication</h4>
        <ul style="font-size: 14px; margin-bottom: 0;">
            <li>Enable 2FA using an authenticator app</li>
            <li>Keep backup codes in a safe place</li>
            <li>Never share 2FA codes with anyone</li>
            <li>Update your phone number if it changes</li>
            <li>Use app-based 2FA over SMS when possible</li>
        </ul>
    </div>
</div>

<div style="display: flex; flex-wrap: wrap; gap: 20px; margin: 20px 0;">
    <div style="flex: 1; min-width: 300px; background-color: #f8f9fa; padding: 20px; border-radius: 6px; border-left: 4px solid #ff6600;">
        <h4 style="color: #ff6600; margin-top: 0;">🌐 Safe Browsing Habits</h4>
        <ul style="font-size: 14px; margin-bottom: 0;">
            <li>Always type mita.finance directly in your browser</li>
            <li>Look for the green lock icon (HTTPS)</li>
            <li>Never click financial links in emails</li>
            <li>Avoid using public WiFi for banking</li>
            <li>Keep your browser and OS updated</li>
        </ul>
    </div>
    
    <div style="flex: 1; min-width: 300px; background-color: #f8f9fa; padding: 20px; border-radius: 6px; border-left: 4px solid #6f42c1;">
        <h4 style="color: #6f42c1; margin-top: 0;">🖥️ Device Security</h4>
        <ul style="font-size: 14px; margin-bottom: 0;">
            <li>Keep devices locked with strong PINs/passwords</li>
            <li>Install security updates promptly</li>
            <li>Use reputable antivirus software</li>
            <li>Don't save passwords in browsers on shared devices</li>
            <li>Log out of accounts on public computers</li>
        </ul>
    </div>
</div>

<h2>🔍 How We Detect Suspicious Activity</h2>

<p>MITA Finance uses advanced AI and machine learning to protect your account:</p>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
    <div style="text-align: center; padding: 20px; background-color: #f8f9fa; border-radius: 6px;">
        <div style="font-size: 32px; margin-bottom: 10px;">🤖</div>
        <strong>AI Monitoring</strong>
        <p style="font-size: 12px; margin: 10px 0 0 0; color: #6c757d;">24/7 behavioral analysis</p>
    </div>
    
    <div style="text-align: center; padding: 20px; background-color: #f8f9fa; border-radius: 6px;">
        <div style="font-size: 32px; margin-bottom: 10px;">🌍</div>
        <strong>Location Tracking</strong>
        <p style="font-size: 12px; margin: 10px 0 0 0; color: #6c757d;">Unusual location detection</p>
    </div>
    
    <div style="text-align: center; padding: 20px; background-color: #f8f9fa; border-radius: 6px;">
        <div style="font-size: 32px; margin-bottom: 10px;">⏱️</div>
        <strong>Time Analysis</strong>
        <p style="font-size: 12px; margin: 10px 0 0 0; color: #6c757d;">Unusual timing patterns</p>
    </div>
    
    <div style="text-align: center; padding: 20px; background-color: #f8f9fa; border-radius: 6px;">
        <div style="font-size: 32px; margin-bottom: 10px;">📊</div>
        <strong>Pattern Recognition</strong>
        <p style="font-size: 12px; margin: 10px 0 0 0; color: #6c757d;">Behavioral anomaly detection</p>
    </div>
</div>

<div style="text-align: center; margin: 40px 0;">
    <h3>Don't wait - secure your account now</h3>
    <a href="https://app.mita.finance/security/emergency" class="btn btn-danger">Take Security Action</a>
    <a href="https://app.mita.finance/account/activity" class="btn">Review Account Activity</a>
</div>

<p>Your security is our highest priority,<br>
<strong>The MITA Finance Security Team</strong></p>

<div style="border-top: 2px solid #cc0000; padding-top: 20px; margin-top: 40px; background-color: #fff5f5; padding: 20px; border-radius: 6px;">
    <h4 style="color: #cc0000; margin-top: 0;">🚨 CRITICAL SECURITY ALERT</h4>
    <p style="font-size: 12px; color: #cc0000; margin-bottom: 10px;"><strong>Alert ID:</strong> {{ alert_id if alert_id else 'SA-' + timestamp|replace(' ', '')|replace(':', '') }}</p>
    <p style="font-size: 12px; color: #cc0000; margin-bottom: 10px;"><strong>Threat Level:</strong> High</p>
    <p style="font-size: 12px; color: #cc0000; margin-bottom: 10px;"><strong>Detected:</strong> {{ timestamp }}</p>
    <p style="font-size: 12px; color: #cc0000; margin-bottom: 15px;"><strong>Status:</strong> Requires Immediate Action</p>
    
    <p style="font-size: 11px; color: #6c757d;">
        <strong>IMPORTANT:</strong> This is an automated security alert generated by MITA Finance's fraud detection system. This email contains time-sensitive security information. If you believe this alert is fraudulent, please forward it to <a href="mailto:security@mita.finance">security@mita.finance</a> immediately.
    </p>
</div>
{% endblock %}