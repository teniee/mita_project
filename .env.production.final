# =====================================================================
# MITA Finance - Production Environment Configuration - FINAL
# PRODUCTION READY - All API keys configured with secure placeholders
# =====================================================================

# ========================================
# ENVIRONMENT SETTINGS
# ========================================
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO
HOST=0.0.0.0
PORT=8000

# Feature Flags - Production Optimized
FEATURE_FLAGS_ADMIN_ENDPOINTS=true
FEATURE_FLAGS_ADVANCED_OCR=true
FEATURE_FLAGS_AI_BUDGET_ANALYSIS=true
FEATURE_FLAGS_CIRCUIT_BREAKER=true
FEATURE_FLAGS_ENHANCED_RATE_LIMITING=true
FEATURE_FLAGS_JWT_ROTATION=true
FEATURE_FLAGS_PUSH_NOTIFICATIONS=true
FEATURE_FLAGS_DETAILED_ANALYTICS=true
FEATURE_FLAGS_DEBUG_LOGGING=false
FEATURE_FLAGS_NEW_BUDGET_ENGINE_ROLLOUT=100

# ========================================
# DATABASE CONFIGURATION - PRODUCTION POSTGRESQL
# ========================================
# NOTE: DATABASE_URL will be auto-provided by Render.com PostgreSQL service
DATABASE_URL=${DATABASE_URL}
POSTGRES_USER=mita_user
POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
POSTGRES_DB=mita_production
POSTGRES_HOST=${POSTGRES_HOST}
POSTGRES_PORT=5432

# Database Connection Pool Settings (Production Optimized)
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
DB_POOL_PRE_PING=true

# ========================================
# REDIS CONFIGURATION - UPSTASH PRODUCTION
# ========================================
# Primary Redis Connection - Upstash (Production Ready)
UPSTASH_REDIS_URL=${UPSTASH_REDIS_URL}
UPSTASH_REDIS_REST_URL=${UPSTASH_REDIS_REST_URL}
UPSTASH_REDIS_REST_TOKEN=${UPSTASH_REDIS_REST_TOKEN}

# Redis Connection Settings (Production Optimized)
REDIS_MAX_CONNECTIONS=20
REDIS_TIMEOUT=30
REDIS_RETRY_ON_TIMEOUT=true
REDIS_SOCKET_KEEPALIVE=true
REDIS_SOCKET_KEEPALIVE_OPTIONS={}

# ========================================
# SECURITY & AUTHENTICATION - PRODUCTION SECURE SECRETS
# ========================================
JWT_SECRET=${JWT_SECRET}
JWT_PREVIOUS_SECRET=${JWT_PREVIOUS_SECRET}
SECRET_KEY=${SECRET_KEY}
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Password Security (Financial Grade)
BCRYPT_ROUNDS_PRODUCTION=12
BCRYPT_PERFORMANCE_TARGET_MS=500

# ========================================
# EXTERNAL SERVICES - PRODUCTION API KEYS
# ========================================

# OpenAI API - AI-powered financial analysis and advice
OPENAI_API_KEY=${OPENAI_API_KEY}
OPENAI_MODEL=gpt-4o-mini
OPENAI_TIMEOUT=30
OPENAI_MAX_RETRIES=3
OPENAI_RATE_LIMIT_REQUESTS=1000
OPENAI_RATE_LIMIT_TOKENS=100000

# Sentry - Error monitoring and performance tracking
SENTRY_DSN=${SENTRY_DSN}
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=${SENTRY_RELEASE}

# Firebase/Google Cloud - Push notifications and authentication
GOOGLE_APPLICATION_CREDENTIALS=/app/secrets/firebase-service-account.json
FIREBASE_JSON=${FIREBASE_JSON}
FIREBASE_PROJECT_ID=${FIREBASE_PROJECT_ID}
FIREBASE_PRIVATE_KEY_ID=${FIREBASE_PRIVATE_KEY_ID}
FIREBASE_PRIVATE_KEY=${FIREBASE_PRIVATE_KEY}
FIREBASE_CLIENT_EMAIL=${FIREBASE_CLIENT_EMAIL}
FIREBASE_CLIENT_ID=${FIREBASE_CLIENT_ID}
FIREBASE_AUTH_URI=https://accounts.google.com/o/oauth2/auth
FIREBASE_TOKEN_URI=https://oauth2.googleapis.com/token

# Apple Services - App Store and Push Notifications
APPSTORE_SHARED_SECRET=${APPSTORE_SHARED_SECRET}
APNS_KEY=/app/secrets/apns-key.p8
APNS_KEY_ID=${APNS_KEY_ID}
APNS_TEAM_ID=${APNS_TEAM_ID}
APNS_TOPIC=com.mita.finance
APNS_USE_SANDBOX=false

# ========================================
# EMAIL CONFIGURATION - SENDGRID PRODUCTION
# ========================================
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USERNAME=apikey
SMTP_PASSWORD=${SENDGRID_API_KEY}
SMTP_FROM=noreply@mita.finance
SMTP_FROM_NAME=MITA Finance
EMAIL_API_KEY=${SENDGRID_API_KEY}

# Alternative Email Providers (Fallback)
MAILGUN_API_KEY=${MAILGUN_API_KEY}
MAILGUN_DOMAIN=${MAILGUN_DOMAIN}
POSTMARK_API_KEY=${POSTMARK_API_KEY}

# ========================================
# CLOUD STORAGE - AWS S3 PRODUCTION
# ========================================
AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
AWS_DEFAULT_REGION=us-east-1
AWS_S3_BUCKET=mita-production-storage
BACKUP_BUCKET=mita-production-backups

# S3 Configuration
S3_ENDPOINT_URL=https://s3.amazonaws.com
S3_USE_SSL=true
S3_ADDRESSING_STYLE=path
S3_SIGNATURE_VERSION=s3v4

# CloudFront CDN
CLOUDFRONT_DOMAIN=${CLOUDFRONT_DOMAIN}
CLOUDFRONT_KEY_PAIR_ID=${CLOUDFRONT_KEY_PAIR_ID}
CLOUDFRONT_PRIVATE_KEY=${CLOUDFRONT_PRIVATE_KEY}

# ========================================
# ADDITIONAL EXTERNAL SERVICES
# ========================================

# Stripe - Payment processing (if needed)
STRIPE_PUBLISHABLE_KEY=${STRIPE_PUBLISHABLE_KEY}
STRIPE_SECRET_KEY=${STRIPE_SECRET_KEY}
STRIPE_WEBHOOK_SECRET=${STRIPE_WEBHOOK_SECRET}

# Plaid - Banking integrations (if needed)
PLAID_CLIENT_ID=${PLAID_CLIENT_ID}
PLAID_SECRET=${PLAID_SECRET}
PLAID_PUBLIC_KEY=${PLAID_PUBLIC_KEY}
PLAID_ENVIRONMENT=production

# Twilio - SMS notifications (if needed)
TWILIO_ACCOUNT_SID=${TWILIO_ACCOUNT_SID}
TWILIO_AUTH_TOKEN=${TWILIO_AUTH_TOKEN}
TWILIO_PHONE_NUMBER=${TWILIO_PHONE_NUMBER}

# ========================================
# MONITORING & LOGGING - PRODUCTION GRADE
# ========================================

# Prometheus Metrics
PROMETHEUS_MULTIPROC_DIR=/tmp/prometheus_multiproc
ENABLE_METRICS=true
METRICS_PORT=8001

# DataDog (Alternative monitoring)
DATADOG_API_KEY=${DATADOG_API_KEY}
DATADOG_APP_KEY=${DATADOG_APP_KEY}

# New Relic (Alternative monitoring)
NEW_RELIC_LICENSE_KEY=${NEW_RELIC_LICENSE_KEY}
NEW_RELIC_APP_NAME=MITA-Finance-Production

# ========================================
# CORS & SECURITY - PRODUCTION SETTINGS
# ========================================
ALLOWED_ORIGINS=https://app.mita.finance,https://admin.mita.finance,https://mita.finance
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
CORS_ALLOW_HEADERS=*
CORS_MAX_AGE=86400

# Security Headers
HSTS_MAX_AGE=31536000
CSP_REPORT_URI=/api/security/csp-report

# ========================================
# RATE LIMITING - PRODUCTION SETTINGS
# ========================================
# Global Rate Limits
RATE_LIMIT_ENABLED=true
RATE_LIMIT_STRATEGY=sliding_window
DEFAULT_RATE_LIMIT=100/minute
AUTH_RATE_LIMIT=20/minute
API_RATE_LIMIT=1000/minute

# Per-endpoint Rate Limits
RATE_LIMIT_LOGIN=5/minute
RATE_LIMIT_REGISTER=3/minute
RATE_LIMIT_PASSWORD_RESET=2/minute
RATE_LIMIT_TRANSACTION_CREATE=10/minute

# ========================================
# APPLICATION PERFORMANCE - PRODUCTION TUNED
# ========================================
# Worker Configuration
WEB_CONCURRENCY=4
WORKER_TIMEOUT=30
KEEPALIVE_TIMEOUT=2
MAX_REQUESTS=1000
MAX_REQUESTS_JITTER=50

# Task Queue Configuration
WORKER_MAX_JOBS=100
WORKER_JOB_TIMEOUT=600
WORKER_HEARTBEAT_INTERVAL=30
TASK_RESULT_TTL=86400
FAILED_TASK_TTL=604800

# Caching
CACHE_TTL_DEFAULT=300
CACHE_TTL_USER_DATA=900
CACHE_TTL_STATIC=3600
CACHE_MAX_SIZE=10000

# ========================================
# BACKUP & STORAGE SETTINGS
# ========================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION_ENABLED=true

# File Upload Settings
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=jpg,jpeg,png,pdf
UPLOAD_PATH=/app/uploads

# ========================================
# HEALTH CHECKS & MONITORING
# ========================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=10
DATABASE_HEALTH_CHECK_TIMEOUT=5

# Startup Configuration
STARTUP_TIMEOUT=60
SHUTDOWN_TIMEOUT=30

# ========================================
# DEPLOYMENT CONFIGURATION
# ========================================
# Render.com specific settings
RENDER=true
PYTHONUNBUFFERED=1
PYTHONDONTWRITEBYTECODE=1
PYTHONPATH=/opt/render/project/src

# Container Settings
CONTAINER_MEMORY_LIMIT=512MB
CONTAINER_CPU_LIMIT=0.5

# ========================================
# PRODUCTION SECURITY COMPLIANCE
# ========================================
# Financial Application Security
PCI_DSS_COMPLIANT=true
ENCRYPTION_AT_REST=true
ENCRYPTION_IN_TRANSIT=true
AUDIT_LOGGING_ENABLED=true
SESSION_SECURE=true
SECURE_COOKIES=true

# Data Retention (Financial Compliance)
DATA_RETENTION_YEARS=7
TRANSACTION_LOG_RETENTION_YEARS=7
AUDIT_LOG_RETENTION_YEARS=7

# =====================================================================
# API KEY SETUP INSTRUCTIONS:
# =====================================================================
# 1. Replace all ${VARIABLE_NAME} placeholders with actual production values
# 2. Set these as environment variables in Render.com dashboard (secure)
# 3. Never commit actual API keys to version control
# 4. Use separate API keys for staging vs production environments
# 5. Implement API key rotation procedures (see rotation guide below)
# 6. Monitor API key usage and set up alerts for failures
# =====================================================================

# =====================================================================
# REQUIRED API KEYS FOR PRODUCTION:
# =====================================================================
# CRITICAL (System won't function without these):
# - OPENAI_API_KEY: Get from https://platform.openai.com/api-keys
# - SENTRY_DSN: Get from https://sentry.io/settings/projects/
# - SENDGRID_API_KEY: Get from https://app.sendgrid.com/settings/api_keys
# - UPSTASH_REDIS_URL: Get from https://upstash.com/
# 
# IMPORTANT (Core features may be limited):
# - FIREBASE_JSON: Firebase service account JSON
# - AWS_ACCESS_KEY_ID / AWS_SECRET_ACCESS_KEY: For file storage
# 
# OPTIONAL (Additional features):
# - STRIPE_SECRET_KEY: For payment processing
# - PLAID_SECRET: For bank account linking
# - TWILIO_AUTH_TOKEN: For SMS notifications
# =====================================================================